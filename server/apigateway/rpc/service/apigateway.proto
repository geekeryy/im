syntax = "proto3";

package apigateway;
option go_package = "./;service";

service APIGateway {
    rpc SessionList(SessionListRequest) returns (SessionListResponse);
    rpc HistoryMessage(HistoryMessageRequest) returns (HistoryMessageResponse);
}

message HistoryMessageRequest {
    string session_uuid = 1; // 会话UUID
    int64 start_seqid = 2; // 开始序列号
}

message HistoryMessageResponse {
    repeated Message messages = 1; // 消息列表
}

message Message{
    string message_uuid = 1; // 消息UUID
    string session_uuid = 2; // 会话UUID
    int64 seq_id = 3; // 消息序列号ID
    string message_type = 4; // 消息类型
    string content = 5;     // 消息内容
    string sender_uuid = 6; // 消息发送者UUID
    string sender_name = 7; // 消息发送者名称
    string sender_avatar = 8; // 消息发送者头像
    string send_time = 9; // 消息时间
}

message SessionListRequest {
    string user_uuid = 1; // 用户UUID
}
message SessionListResponse {
    repeated Session sessions = 1; // 会话列表
}
message Session {
    string uuid = 1; // 会话UUID
    string name = 2; // 会话名称
    string avatar = 3; // 会话头像
    string last_message = 4; // 最后一条消息
    string last_time = 5; // 最后一条消息时间
    int64 unread_count = 6; // 未读消息数
}

